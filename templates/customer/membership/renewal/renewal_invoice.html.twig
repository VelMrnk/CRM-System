<div class="col-md-8 col-md-offset-2 invoice">
    <div class="row invoice-header">
        {% set client = invoice.member.client %}
        {% set currency = client.currencyFormat %}

        {% if invoice.isPaid %}
            <div class="bg-success">
                <h2 class="text-semibold text-center">{{ 'label.completed'|trans({}, 'labels')|upper }}</h2>
            </div>
        {% else %}
            <div class="bg-orange">
                <h2 class="text-semibold text-center">{{ 'label.pending'|trans({}, 'labels')|upper }}</h2>
            </div>
        {% endif %}
    </div>

    <div class="invoice-body">
        <div class="row">
            <div class="col-md-6 col-xs-6">
                <span class="text-semibold">{{ invoice.createdAt|date("F j, Y") }}</span> <br/>
                {{ invoice.createdAt|date('g:ia') }}
            </div>
            <div class="col-md-6 col-xs-6">
                <span class="text-semibold">{{ 'invoice.transaction'|trans({}, 'labels') }} ID</span> <br/>
                {% if invoice.refnum %}
                    {{ invoice.refnum }}
                {% else %}
                    -
                {% endif %}
            </div>
        </div>

        <hr/>

        <div class="row">
            <h4 class="text-semibold">{{ 'invoice.title'|trans({}, 'labels') }}</h4>
            {% if client.textEditor %}
                {{ client.textEditor.marketDescription|raw }}
                <hr/>
            {% endif %}

            {% if invoice.location %}
                {% set locationType = invoice.location.isDelivery ? 'delivery' : 'pickup' %}
                <table class="table invoice-location">
                    <thead>
                    <tr>
                        <th>{{ 'customer.location.location'|trans({}, 'labels') }}</th>
                        <th>{{ ('membership.renew.location.' ~ locationType ~ '_day')|trans({}, 'labels') }}</th>
                        <th>{{ ('membership.renew.location.' ~ locationType ~ '_date')|trans({}, 'labels') }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>{{ invoice.location.isDelivery
                            ? 'membership.renew.location.home_delivery'|trans({}, 'labels')|upper
                            : invoice.location.name }}</td>
                        <td>{{ invoice.orderDate ? (invoice.orderDate|date('l')|lower)|trans({}, 'choices') }}</td>
                        <td>{{ invoice.orderDate ? invoice.orderDate|date(client.getTwigFormatDate()) }}</td>
                    </tr>
                    </tbody>
                </table>

                <hr/>
            {% endif %}

            {% if invoice.location and invoice.location.isDelivery and invoice.member.getAddressByType('DELIVERY')
                and invoice.member.getAddressByType('DELIVERY').getTypeName() == 'Delivery' %}
                <span class="text-semibold">{{ 'membership.renew.addresses.delivery_address'|trans({}, 'labels') }}</span><br/>
                {{ invoice.member.getFullname }}<br/>
                <p>{{ invoice.member.getAddressByType('Delivery')|address_format|raw }}</p>
            {% endif %}

            {% set billingAddress = invoice.member.getAddressByType('Billing') %}

            <span class="text-semibold">
                {% if invoice.location and invoice.location.isDelivery and billingAddress.getTypeName() == 'Billing and Delivery' %}
                    {{ 'membership.renew.addresses.billing_and_delivery_address'|trans({}, 'labels') }}
                {% else %}
                    {{ 'membership.renew.addresses.billing_address'|trans({}, 'labels') }}
                {% endif %}
            </span>
            <br/>
            {{ invoice.member.getFullname }}<br/>
            {{ invoice.member.getAddressByType('Billing')|address_format|raw }}<br/>
        </div>

        <div class="row">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                    <tr class="row-style">
                        <th>{{ 'membership.customize.product_name'|trans({}, 'labels') }}</th>
                        <th class="text-center">{{ 'membership.renew.qty'|trans({}, 'labels')|capitalize }}</th>
                        <th class="text-center">{{ 'product.weight'|trans({}, 'labels')|capitalize }}</th>
                        <th class="text-right">{{ 'membership.customize.price'|trans({}, 'labels') }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for item in invoice.items %}
                        <tr>
                            <td>{{ item.share ? item.share.name : item.product.name }}</td>
                            <td class="text-center">{{ item.qty }}</td>
                            <td class="text-center">{{ item.weight ? item.weight ~ ' ' ~ client.weightName }}</td>
                            <td class="text-right">{{ currency }}{{ item.amount|number_format(2, '.', ',') }}</td>
                        </tr>
                    {% endfor %}
                    <tr class="text-center">
                        <td class="text-right" colspan="4">
                            <span class="text-semibold">
                                {{ 'invoice.amount_paid'|trans({}, 'labels') }}:
                                {{ currency }}{{ invoice.paid ? invoice.amount|number_format(2, '.', ',') : '0.00' }}
                            </span>
                        </td>
                    </tr>
                    <tr class="text-center">
                        <td class="text-right" colspan="4">
                            <span class="text-semibold">
                                {{ 'invoice.total_owed'|trans({}, 'labels') }}:
                                {{ currency }}{{ invoice.paid ? '0.00' : invoice.amount|number_format(2, '.', ',') }}
                            </span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<link href="{{ asset('css/pages/widgets/market.css') }}" rel="stylesheet" type="text/css">
<script>
    // If template inside profile page -> click on renew tab
    var $renewTab = $('.nav-tabs a[href$="renew"]');
    if ($renewTab.length) $renewTab.trigger('click');
</script>